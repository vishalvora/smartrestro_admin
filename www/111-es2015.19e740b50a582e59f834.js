(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{"8cDG":function(l,n,t){"use strict";t.r(n);var e=t("8Y7J");class o{}var u=t("pMnS"),i=t("MKJQ"),r=t("sZkV"),c=t("s7LF"),s=t("SVse"),a=t("mrSG"),d=t("ZJFI"),b=t("2PDc"),h=t("jVAA"),g=t("iqUP"),p=t("XVYp"),m=t("JR7c");class f{constructor(l,n,t,e,o,u,i){this.db=l,this.dbService=n,this.modalController=t,this.alertController=e,this.loadingController=o,this.modalCtrl=u,this.ngZone=i,this.productList=[],this.searchList=[],this.a=!0,this.productIds=[],this.categoryList=[],this.segCtrl=!0,this.searchbar=!1}ngOnInit(){this.dbService.getStore().subscribe(l=>{console.log(l),Object.keys(l).length>0&&(console.log("running due to not null"),this.storeId=l.store_id,l.category&&(console.log("there is category"),this.categoryList=l.category,console.log(this.categoryList),console.log(this.storeId),this.selectedCatalogue=this.categoryList[0]),this.categoryList.length>0&&this.segmentChanged("ev"))})}segmentChanged(l){console.log(this.selectedCatalogue),this.db.firestore.collection("product_seller").where("storeID","==",this.storeId).where("category","==",this.selectedCatalogue).orderBy("product_id","asc").limit(15).onSnapshot(l=>{let n={};this.productList=[],this.productIds=[],this.ngZone.run(()=>{l.forEach(l=>{console.log(l.id),n=l.data(),n.doc_id=l.id,this.productList.push(n),this.productIds.push(n.product_id)})})})}close(){this.a=!1}priceSet(l){console.log("setting price"),console.log(l),console.log(),this.db.collection("product_seller").doc(l.doc_id).set({variants:l.variants},{merge:!0}).then(l=>{console.log(l)})}priceChnage(l,n){console.log("changing price");const t=g.firestore.FieldValue.increment(n);l.price=parseFloat(l.price)+1,this.db.firestore.collection("product_seller").doc(l.doc_id).update({price:t}).then(l=>{console.log(l)})}presentImportModal(){return a.__awaiter(this,void 0,void 0,(function*(){const l=yield this.modalController.create({component:b.a,componentProps:{productIds_:"this.productIds"}});return yield l.present()}))}dismissLoading(){this.loadingController.dismiss({dismissed:!0})}loading(){return a.__awaiter(this,void 0,void 0,(function*(){const l=yield this.loadingController.create({message:"Please wait..."});yield l.present(),yield l.onDidDismiss(),console.log("Loading dismissed!")}))}deleteProduct(l,n){console.log(l),this.productList.splice(n,1),this.db.collection("product_seller").doc(l.doc_id).delete().then(l=>{console.log("product deleted")}),this.db.collection("productList_seller").doc(this.storeId).get().subscribe(n=>{console.log(n.data());let t=n.data().productList.indexOf(l.product_id);console.log(t);let e=n.data().productList;e.splice(t,1),console.log(e),this.db.collection("productList_seller").doc(this.storeId).set({productList:e})})}deleteProductAlert(l,n){return a.__awaiter(this,void 0,void 0,(function*(){const t=yield this.alertController.create({header:"Confirm!",message:"delete product?",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:l=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>{console.log("Confirm Okay"),this.deleteProduct(l,n)}}]});yield t.present()}))}presentModalAdd(){return a.__awaiter(this,void 0,void 0,(function*(){const l=yield this.modalController.create({component:h.a});return yield l.present()}))}search(l){console.log(l.detail),this.db.firestore.collection("product_seller").where("storeID","==",this.storeId).where("search","array-contains",l.detail.value.toLowerCase()).get().then(l=>{console.log(l),this.searchList=[],this.ngZone.run(()=>{l.forEach(l=>{let n={};n=l.data(),n.doc_id=l.id,this.searchList.push(n)})})})}test(){console.log("ion focus chae"),this.segCtrl=!1}ionBlur(){console.log("blur"),this.segCtrl=!0,this.searchbar=!this.searchbar}ionClear(){}searchBar(){console.log(this.searchbar),this.searchbar=!this.searchbar}presentModalProductEdit(l){return a.__awaiter(this,void 0,void 0,(function*(){const n=yield this.modalController.create({component:p.a,componentProps:{id:l,cat:this.categoryList}});return yield n.present()}))}loadMoreProduct(l){this.db.firestore.collection("product_seller").where("storeID","==",this.storeId).where("category","==",this.selectedCatalogue).orderBy("product_id","asc").limit(15).startAfter(this.productList[this.productList.length-1].product_id).get().then(n=>{let t=[],e={};n.docChanges().forEach(l=>{e=l.doc.data(),e.doc_id=l.doc.id,t.push(e)}),this.ngZone.run(()=>{this.productList=[...this.productList,...t]}),l.target.complete()})}snap(l){this.db.firestore.collection("product_seller").where("storeID","==",this.storeId).onSnapshot(l=>{let n=[],t={};l.docChanges().forEach(l=>{if(console.log(l.type),console.log(l.doc.data()),"added"===l.type&&(t=l.doc.data(),t.doc_id=l.doc.id,n.push(t)),"modified"===l.type){console.log("document modified"),t=l.doc.data(),t.doc_id=l.doc.id;let n=this.productList.findIndex(n=>n.doc_id===l.doc.id);console.log(n),this.productList.splice(n,1),this.productList.splice(n,0,t)}}),this.ngZone.run(()=>{this.productList=[...this.productList,...n]})})}presentCatModal(){return a.__awaiter(this,void 0,void 0,(function*(){const l=yield this.modalController.create({component:m.a,componentProps:{storeId:this.storeId}});return yield l.present()}))}}var x=t("wD+u"),C=e.pb({encapsulation:0,styles:[["ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:translucent}"]],data:{}});function v(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,3,"ion-title",[],null,null,null,i.tb,i.I)),e.qb(1,49152,null,0,r.yb,[e.h,e.k,e.x],null,null),(l()(),e.rb(2,0,null,0,1,"div",[],null,null,null,null,null)),(l()(),e.Jb(-1,null,["Products"]))],null,null)}function k(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,3,"ion-searchbar",[["animated",""],["cancelButtonIcon","arrow-back-outline"],["debounce","500"],["showCancelButton","always"],["style","--box-shadow: none;"]],null,[[null,"ionChange"],[null,"ionFocus"],[null,"ionClear"],[null,"ionCancel"],[null,"ionBlur"]],(function(l,n,t){var o=!0,u=l.component;return"ionBlur"===n&&(o=!1!==e.Db(l,3)._handleBlurEvent(t.target)&&o),"ionChange"===n&&(o=!1!==e.Db(l,3)._handleInputEvent(t.target)&&o),"ionChange"===n&&(o=!1!==u.search(t)&&o),"ionFocus"===n&&(o=!1!==u.test()&&o),"ionClear"===n&&(o=!1!==u.ionClear()&&o),"ionCancel"===n&&(o=!1!==u.ionBlur()&&o),o}),i.gb,i.v)),e.Gb(5120,null,c.g,(function(l){return[l]}),[r.Nb]),e.qb(2,49152,null,0,r.ib,[e.h,e.k,e.x],{animated:[0,"animated"],cancelButtonIcon:[1,"cancelButtonIcon"],debounce:[2,"debounce"],showCancelButton:[3,"showCancelButton"]},null),e.qb(3,16384,null,0,r.Nb,[e.k],null,null)],(function(l,n){l(n,2,0,"","arrow-back-outline","500","always")}),null)}function y(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,1,"ion-icon",[["name","search-outline"],["size","large"],["slot","end"],["style","transform: scale(0.8); margin-right: 10px;"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.searchBar()&&e),e}),i.V,i.k)),e.qb(1,49152,null,0,r.D,[e.h,e.k,e.x],{name:[0,"name"],size:[1,"size"]},null)],(function(l,n){l(n,1,0,"search-outline","large")}),null)}function _(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,6,"ion-item",[["lines","none"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.presentCatModal()&&e),e}),i.Z,i.o)),e.qb(1,49152,null,0,r.I,[e.h,e.k,e.x],{lines:[0,"lines"]},null),(l()(),e.rb(2,0,null,0,2,"ion-label",[],null,null,null,i.ab,i.p)),e.qb(3,49152,null,0,r.O,[e.h,e.k,e.x],null,null),(l()(),e.Jb(-1,0,["Manage category"])),(l()(),e.rb(5,0,null,0,1,"ion-icon",[["name","chevron-forward-outline"]],null,null,null,i.V,i.k)),e.qb(6,49152,null,0,r.D,[e.h,e.k,e.x],{name:[0,"name"]},null)],(function(l,n){l(n,1,0,"none"),l(n,6,0,"chevron-forward-outline")}),null)}function I(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,5,"div",[],null,null,null,null,null)),(l()(),e.rb(1,0,null,null,4,"ion-segment-button",[],null,null,null,i.hb,i.x)),e.qb(2,49152,null,0,r.kb,[e.h,e.k,e.x],{value:[0,"value"]},null),(l()(),e.rb(3,0,null,0,2,"ion-label",[],null,null,null,i.ab,i.p)),e.qb(4,49152,null,0,r.O,[e.h,e.k,e.x],null,null),(l()(),e.Jb(5,0,["",""]))],(function(l,n){l(n,2,0,e.vb(1,"",n.context.$implicit,""))}),(function(l,n){l(n,5,0,n.context.$implicit)}))}function q(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,11,"div",[["style","padding-bottom:20px"]],null,null,null,null,null)),(l()(),e.rb(1,0,null,null,10,"ion-item",[["lines","none"]],null,null,null,i.Z,i.o)),e.qb(2,49152,null,0,r.I,[e.h,e.k,e.x],{lines:[0,"lines"]},null),(l()(),e.rb(3,0,null,0,2,"ion-thumbnail",[["slot","start"],["style","padding-right:10px; width:80px; height:80px"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.presentModalProductEdit(l.context.$implicit.doc_id)&&e),e}),i.sb,i.H)),e.qb(4,49152,null,0,r.xb,[e.h,e.k,e.x],null,null),(l()(),e.rb(5,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(l()(),e.rb(6,0,null,0,3,"ion-label",[],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.presentModalProductEdit(l.context.$implicit.doc_id)&&e),e}),i.ab,i.p)),e.qb(7,49152,null,0,r.O,[e.h,e.k,e.x],null,null),(l()(),e.rb(8,0,null,0,1,"div",[],null,null,null,null,null)),(l()(),e.Jb(9,null,[" "," "])),(l()(),e.rb(10,0,null,0,1,"ion-icon",[["name","trash-outline"],["slot","end"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.deleteProductAlert(l.context.$implicit,l.context.index)&&e),e}),i.V,i.k)),e.qb(11,49152,null,0,r.D,[e.h,e.k,e.x],{name:[0,"name"]},null)],(function(l,n){l(n,2,0,"none"),l(n,11,0,"trash-outline")}),(function(l,n){l(n,5,0,e.vb(1,"",n.context.$implicit.image_url,"")),l(n,9,0,n.context.$implicit.name)}))}function w(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,17,"div",[],null,null,null,null,null)),(l()(),e.rb(1,0,null,null,8,"ion-segment",[["scrollable",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ionChange"],[null,"ngModelChange"],[null,"ionBlur"]],(function(l,n,t){var o=!0,u=l.component;return"ionBlur"===n&&(o=!1!==e.Db(l,3)._handleBlurEvent(t.target)&&o),"ionChange"===n&&(o=!1!==e.Db(l,3)._handleChangeEvent(t.target)&&o),"ionChange"===n&&(o=!1!==u.segmentChanged(t)&&o),"ngModelChange"===n&&(o=!1!==(u.selectedCatalogue=t)&&o),o}),i.ib,i.w)),e.qb(2,49152,null,0,r.jb,[e.h,e.k,e.x],{scrollable:[0,"scrollable"]},null),e.qb(3,16384,null,0,r.Mb,[e.k],null,null),e.Gb(1024,null,c.g,(function(l){return[l]}),[r.Mb]),e.qb(5,671744,null,0,c.l,[[8,null],[8,null],[8,null],[6,c.g]],{model:[0,"model"]},{update:"ngModelChange"}),e.Gb(2048,null,c.h,null,[c.l]),e.qb(7,16384,null,0,c.i,[[4,c.h]],null,null),(l()(),e.gb(16777216,null,0,1,null,I)),e.qb(9,278528,null,0,s.h,[e.O,e.K,e.q],{ngForOf:[0,"ngForOf"]},null),(l()(),e.rb(10,0,null,null,3,"ion-list",[],null,null,null,i.cb,i.q)),e.qb(11,49152,null,0,r.P,[e.h,e.k,e.x],null,null),(l()(),e.gb(16777216,null,0,1,null,q)),e.qb(13,278528,null,0,s.h,[e.O,e.K,e.q],{ngForOf:[0,"ngForOf"]},null),(l()(),e.rb(14,0,null,null,3,"ion-infinite-scroll",[["threshold","100px"]],null,[[null,"ionInfinite"]],(function(l,n,t){var e=!0;return"ionInfinite"===n&&(e=!1!==l.component.loadMoreProduct(t)&&e),e}),i.X,i.l)),e.qb(15,49152,null,0,r.F,[e.h,e.k,e.x],{threshold:[0,"threshold"]},null),(l()(),e.rb(16,0,null,0,1,"ion-infinite-scroll-content",[["loadingSpinner","bubbles"],["loadingText","Loading more data..."]],null,null,null,i.W,i.m)),e.qb(17,49152,null,0,r.G,[e.h,e.k,e.x],{loadingSpinner:[0,"loadingSpinner"],loadingText:[1,"loadingText"]},null)],(function(l,n){var t=n.component;l(n,2,0,""),l(n,5,0,t.selectedCatalogue),l(n,9,0,t.categoryList),l(n,13,0,t.productList),l(n,15,0,"100px"),l(n,17,0,"bubbles","Loading more data...")}),(function(l,n){l(n,1,0,e.Db(n,7).ngClassUntouched,e.Db(n,7).ngClassTouched,e.Db(n,7).ngClassPristine,e.Db(n,7).ngClassDirty,e.Db(n,7).ngClassValid,e.Db(n,7).ngClassInvalid,e.Db(n,7).ngClassPending)}))}function L(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,10,"div",[["style","padding-bottom:20px"]],null,null,null,null,null)),(l()(),e.rb(1,0,null,null,9,"ion-item",[["lines","none"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.presentModalProductEdit(l.context.$implicit.doc_id)&&e),e}),i.Z,i.o)),e.qb(2,49152,null,0,r.I,[e.h,e.k,e.x],{lines:[0,"lines"]},null),(l()(),e.rb(3,0,null,0,2,"ion-thumbnail",[["slot","start"],["style","padding-right:10px; width:80px; height:80px"]],null,null,null,i.sb,i.H)),e.qb(4,49152,null,0,r.xb,[e.h,e.k,e.x],null,null),(l()(),e.rb(5,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(l()(),e.rb(6,0,null,0,2,"ion-label",[],null,null,null,i.ab,i.p)),e.qb(7,49152,null,0,r.O,[e.h,e.k,e.x],null,null),(l()(),e.Jb(8,0,["",""])),(l()(),e.rb(9,0,null,0,1,"ion-icon",[["name","trash-outline"],["slot","end"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.deleteProductAlert(l.context.$implicit,l.context.index)&&e),e}),i.V,i.k)),e.qb(10,49152,null,0,r.D,[e.h,e.k,e.x],{name:[0,"name"]},null)],(function(l,n){l(n,2,0,"none"),l(n,10,0,"trash-outline")}),(function(l,n){l(n,5,0,e.vb(1,"",n.context.$implicit.image_url,"")),l(n,8,0,n.context.$implicit.name)}))}function B(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,3,"ion-list",[["style","padding-top:70px;"]],null,null,null,i.cb,i.q)),e.qb(1,49152,null,0,r.P,[e.h,e.k,e.x],null,null),(l()(),e.gb(16777216,null,0,1,null,L)),e.qb(3,278528,null,0,s.h,[e.O,e.K,e.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){l(n,3,0,n.component.searchList)}),null)}function P(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,9,"ion-header",[],null,null,null,i.U,i.j)),e.qb(1,49152,null,0,r.C,[e.h,e.k,e.x],null,null),(l()(),e.rb(2,0,null,0,7,"ion-toolbar",[],null,null,null,i.vb,i.K)),e.qb(3,49152,null,0,r.Ab,[e.h,e.k,e.x],null,null),(l()(),e.gb(16777216,null,0,1,null,v)),e.qb(5,16384,null,0,s.i,[e.O,e.K],{ngIf:[0,"ngIf"]},null),(l()(),e.gb(16777216,null,0,1,null,k)),e.qb(7,16384,null,0,s.i,[e.O,e.K],{ngIf:[0,"ngIf"]},null),(l()(),e.gb(16777216,null,0,1,null,y)),e.qb(9,16384,null,0,s.i,[e.O,e.K],{ngIf:[0,"ngIf"]},null),(l()(),e.rb(10,0,null,null,11,"ion-content",[],null,null,null,i.T,i.i)),e.qb(11,49152,null,0,r.v,[e.h,e.k,e.x],{fullscreen:[0,"fullscreen"]},null),(l()(),e.gb(16777216,null,0,1,null,_)),e.qb(13,16384,null,0,s.i,[e.O,e.K],{ngIf:[0,"ngIf"]},null),(l()(),e.rb(14,0,null,0,0,"div",[["style","height:8px; background-color: #f5f5f5;"]],null,null,null,null,null)),(l()(),e.gb(16777216,null,0,1,null,w)),e.qb(16,16384,null,0,s.i,[e.O,e.K],{ngIf:[0,"ngIf"]},null),(l()(),e.gb(16777216,null,0,1,null,B)),e.qb(18,16384,null,0,s.i,[e.O,e.K],{ngIf:[0,"ngIf"]},null),(l()(),e.rb(19,0,null,0,2,"div",[["slot","fixed"],["style","display: flex;text-align: center;height: 4  0px;background: var(--ion-color-primary);; bottom: 0;width: 100%;"]],null,null,null,null,null)),(l()(),e.rb(20,0,null,null,1,"div",[["style","width: 100%; line-height: 40px;"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.presentModalProductEdit("new")&&e),e}),null,null)),(l()(),e.Jb(-1,null,["Add Product"]))],(function(l,n){var t=n.component;l(n,5,0,!t.searchbar),l(n,7,0,t.searchbar),l(n,9,0,!t.searchbar),l(n,11,0,!0),l(n,13,0,t.segCtrl),l(n,16,0,t.segCtrl),l(n,18,0,!t.segCtrl)}),null)}function O(l){return e.Kb(0,[(l()(),e.rb(0,0,null,null,1,"app-tab2",[],null,null,null,P,C)),e.qb(1,114688,null,0,f,[x.a,d.a,r.Fb,r.b,r.Eb,r.Fb,e.x],null,null)],(function(l,n){l(n,1,0)}),null)}var D=e.nb("app-tab2",f,O,{},{},[]),K=t("qtYk"),M=t("iInd");t.d(n,"Tab2PageModuleNgFactory",(function(){return F}));var F=e.ob(o,[],(function(l){return e.Ab([e.Bb(512,e.j,e.Z,[[8,[u.a,D]],[3,e.j],e.v]),e.Bb(4608,s.k,s.j,[e.s,[2,s.q]]),e.Bb(4608,r.c,r.c,[e.x,e.g]),e.Bb(4608,r.Fb,r.Fb,[r.c,e.j,e.p]),e.Bb(4608,r.Kb,r.Kb,[r.c,e.j,e.p]),e.Bb(4608,c.p,c.p,[]),e.Bb(1073742336,s.b,s.b,[]),e.Bb(1073742336,r.Cb,r.Cb,[]),e.Bb(1073742336,c.o,c.o,[]),e.Bb(1073742336,c.c,c.c,[]),e.Bb(1073742336,K.a,K.a,[]),e.Bb(1073742336,M.o,M.o,[[2,M.t],[2,M.m]]),e.Bb(1073742336,o,o,[]),e.Bb(1024,M.k,(function(){return[[{path:"",component:f}]]}),[])])}))}}]);